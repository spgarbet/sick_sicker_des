<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="John Graves">
<meta name="author" content="Shawn Garbett">
<meta name="author" content="Kun-Woo Kim">
<meta name="dcterms.date" content="2025-06-03">

<title>1. Overview of Discrete Event Simulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="01-introduction_files/libs/clipboard/clipboard.min.js"></script>
<script src="01-introduction_files/libs/quarto-html/quarto.js"></script>
<script src="01-introduction_files/libs/quarto-html/popper.min.js"></script>
<script src="01-introduction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01-introduction_files/libs/quarto-html/anchor.min.js"></script>
<link href="01-introduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01-introduction_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01-introduction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01-introduction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01-introduction_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="01-introduction_files/libs/quarto-contrib/intersection-observer-polyfill-1.0.0/intersection-observer.js"></script>
<script src="01-introduction_files/libs/quarto-contrib/scrollama-3.2.0/scrollama.min.js"></script>
<script src="01-introduction_files/libs/quarto-contrib/closeread-0.1.0/closeread.js"></script>
<meta cr-debug-mode="false">
<meta cr-remove-header-space="false">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="_extensions/qmd-lab/closeread/closeread.css">
<link rel="stylesheet" href="des-styling.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">1. Overview of Discrete Event Simulation</h1>
<p class="subtitle lead">Discrete Event Simulation for Health Decision Modeling</p>
</div>


<div class="quarto-title-meta-author column-body">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">John Graves <a href="mailto:john.graves@vanderbilt.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Vanderbilt University School of Medicine
          </p>
        <p class="affiliation">
            Vanderbilt Owen Gradute School of Management
          </p>
        <p class="affiliation">
            Vanderbilt University Medical Center
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Shawn Garbett <a href="mailto:shawn.garbett@vumc.org" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Vanderbilt University School of Medicine
          </p>
        <p class="affiliation">
            Vanderbilt University Medical Center
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Kun-Woo Kim </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Vanderbilt University
          </p>
      </div>
  </div>

<div class="quarto-title-meta column-body">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<!-- ::: callout-important -->
<!-- This text was AI-generated just to put in some filler for now; we'll want to go back and edit using our own language.  -->
<!-- ::: -->
<p><span style="color:cornflowerblue"><strong>Discrete event simulation (DES) </strong></span> is a modeling framework offering unique advantages for evaluating health decision problems. DES explicitly models patients’ experience via trajectories that track a series of events occurring over time, such as disease onset, treatment initiation, and other clinical outcomes.</p>
<p>What differentiates DES from other modeling approaches (e.g., discrete time Markov, microsimulation) is that DES can also capture dynamic interactions between patients and system resources—making it particularly valuable for evaluating strategies that affect system capacity, waiting times, or resource utilization.</p>
<p>In what follows, we detail the concepts and execution of DES for health decision analysis. We begin with a conceptual overview of DES, and then build up a DES for a widely-used progressive disease model <span class="citation" data-cites="alarid2023introductory">(<a href="#ref-alarid2023introductory" role="doc-biblioref">Alarid-Escudero et al. 2023</a>)</span>.</p>
<p>We will first build the model and demonstrate that it exactly matches outcomes and ICERs in <span class="citation" data-cites="alarid2023introductory">Alarid-Escudero et al. (<a href="#ref-alarid2023introductory" role="doc-biblioref">2023</a>)</span>. Once equivalence is established, we then build on the model to add a new strategy based on a new treatment with limited treatment capacity.</p>
<section id="conceptual-framework" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="conceptual-framework">Conceptual Framework</h2>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-carrace">
<div class="narrative">
<p>A useful framework for understanding DES is a car race in which each patient represents a car navigating a complex circuit with multiple checkpoints, pit stops, and potential hazards.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-carrace2">
<div class="narrative">
<p>In this framework, each car follows its own unique journey (“trajectory”) through a race course, with discrete events corresponding to key moments like crossing timing markers, making pit stops for fuel and tire changes, or experiencing unexpected mechanical issues that require assistance.</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-carrace" class="sticky">
<p><img src="images/starting-line-cars2.png" class="img-fluid"></p>
</div>
<div id="cr-carrace2" class="sticky">
<p><img src="images/car-race.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<!-- ::: {.column-screen style="background-image:url(images/starting-line-cars2.png); background-size: 100vw; height: 600px; background-position: center bottom; background-repeat: no-repeat; opacity: 0.5"} -->
<!-- ::: -->
<!-- <figcaption>Image generated by ChatGPT 4o</figcaption> -->
<p>In a DES, the modeler tracks not only each car’s total race time but also the precise timing and sequence of every significant event—when cars enter the pit lane, how long they wait for available mechanics, whether they experience delays due to track congestion—and how these operational realities affect both their race performance (i.e., costs, quality-adjusted health outcomes) and resource consumption.</p>
<div class="column-screen" style="background-image:url(images/scoreboard-race.png); background-size: 100vw; height: 600px; background-position: center; background-repeat: no-repeat; opacity: 0.5">

</div>
<figcaption>
Image generated by ChatGPT 4o
</figcaption>
<!-- ::: {.column-screen style="background-image:url(images/finish-line-cars.png); background-size: 100vw; height: 400px; background-position: center +15%; background-repeat: no-repeat; opacity: 0.5"} -->
<!-- ::: -->
<!-- <figcaption>Image generated by ChatGPT 4o</figcaption> -->
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger">
<div class="narrative">
<p>To understand and construct a DES it’s important to define several concepts:</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table">
<div class="narrative">
<p><span style="color:#DF8F44FF"><strong>Tokens</strong></span> represent an individual entity (typically a patient) that flows through the simulation over time.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table">
<div class="narrative">
<p>Tokens take on attributes (e.g., age, gender) that are either fixed throughout the model, or that change as they make their way through the model.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table">
<div class="narrative">
<p>For example, suppose we aim to model different strategies for treating colon cancer. A token might represent a 67-year-old woman with Stage III colorectal cancer.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table2">
<div class="narrative">
<p>Now suppose we want to track this patient’s progression through diagnosis, treatment (e.g., surgery, chemo), remission, and potential relapse. These are examples of <span style="color:#00A1D5FF"><strong>events/transitions</strong></span> in a DES model.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table3">
<div class="narrative">
<p>The specific sequence of events a patient (“token”) experiences is tracked in a <span style="color:#B24745FF"><strong>trajectory</strong></span>.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table4">
<div class="narrative">
<p><span style="color:#79AF97FF"><strong>Resources</strong></span> are the final key element of a DES, and can either be unconstrained and used by everyone, or subject to resource constraints.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>For example, the total amount of time a given patient spends in the model could be considered an unconstrained resource—one patient’s experience of time does not preclude another patient in the model from also experiencing the passage of time.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-table4">
<div class="narrative">
<p>Conversely, in a resource-constrained DES we might want to put limits on the total number of patients who can receive treatment at one time. This both helps better represent real-world scenarios, and also facilitates additional policy strategy modeling (e.g., expansion of treatment slots, staffing, or hospital beds to reduce wait times).</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-table" class="sticky">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 44%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Concept</th>
<th style="text-align: left;">Definition</th>
<th style="text-align: left;">Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style="color:#DF8F44FF"><strong>Tokens</strong></span></td>
<td style="text-align: left;">Represent patients or units flowing through the simulation, carrying attributes.</td>
<td style="text-align: left;">A 67-year-old woman with Stage III colorectal cancer.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cr-table2" class="sticky">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 27%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Concept</th>
<th style="text-align: left;">Definition</th>
<th style="text-align: left;">Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style="color:#DF8F44FF"><strong>Tokens</strong></span></td>
<td style="text-align: left;">Represent patients or units flowing through the simulation, carrying attributes.</td>
<td style="text-align: left;">A 67-year-old woman with Stage III colorectal cancer.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="color:#00A1D5FF"><strong>Events/transitions</strong></span></td>
<td style="text-align: left;">Discrete time points when system state changes; trigger resource use and transitions.</td>
<td style="text-align: left;">- Disease incidence<br> - Disease progression<br> - Death from disease or background causes<br> - Enter treatment waiting list<br> - Acute event (e.g., hospitalization)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cr-table3" class="sticky">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 27%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Concept</th>
<th style="text-align: left;">Definition</th>
<th style="text-align: left;">Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style="color:#DF8F44FF"><strong>Tokens</strong></span></td>
<td style="text-align: left;">Represent patients or units flowing through the simulation, carrying attributes.</td>
<td style="text-align: left;">A 67-year-old woman with Stage III colorectal cancer.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="color:#00A1D5FF"><strong>Events/transitions</strong></span></td>
<td style="text-align: left;">Discrete time points when system state changes; trigger resource use and transitions.</td>
<td style="text-align: left;">- Disease incidence<br> - Disease progression<br> - Death from disease or background causes<br> - Enter treatment waiting list<br> - Acute event (e.g., hospitalization)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style="color:#B24745FF"><strong>Trajectories</strong></span></td>
<td style="text-align: left;">The sequence of events and states a token experiences during the simulation.</td>
<td style="text-align: left;">Patient progresses from diagnosis → treatment → remission → relapse → death</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cr-table4" class="sticky">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Concept</th>
<th style="text-align: left;">Definition</th>
<th style="text-align: left;">Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style="color:#DF8F44FF"><strong>Tokens</strong></span></td>
<td style="text-align: left;">Represent patients or units flowing through the simulation, carrying attributes.</td>
<td style="text-align: left;">A 67-year-old woman with Stage III colorectal cancer.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="color:#00A1D5FF"><strong>Events/transitions</strong></span></td>
<td style="text-align: left;">Discrete time points when system state changes; trigger resource use and transitions.</td>
<td style="text-align: left;">- Disease incidence<br> - Disease progression<br> - Death from disease or background causes<br> - Enter treatment waiting list<br> - Acute event (e.g., hospitalization)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style="color:#B24745FF"><strong>Trajectories</strong></span></td>
<td style="text-align: left;">The sequence of events and states a token experiences during the simulation.</td>
<td style="text-align: left;">Patient progresses from diagnosis → treatment → remission → relapse → death</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="color:#79AF97FF"><strong>Resources</strong></span></td>
<td style="text-align: left;">Entities required or consumed by events; may be limited (constrained) or unlimited (unconstrained).</td>
<td style="text-align: left;">- Total time in healthy state<br> - Total time in sick state<br> - Number of available hospital beds</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-a-des" class="level1">
<h1>Visualizing a DES</h1>
<p>It is often useful to conceptualize a disease or health system process using a state transition diagram that captures mutually exclusive health states and possible transitions among them.</p>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-bubble">
<div class="narrative">
<p>The state transition model here represents the underlying disease process for the didactic Markov cohort model in <span class="citation" data-cites="alarid2023introductory">Alarid-Escudero et al. (<a href="#ref-alarid2023introductory" role="doc-biblioref">2023</a>)</span>.</p>
</div>
</div>
<div class="trigger new-trigger" data-pan-to="50%,0%" data-focus-on="cr-bubble">
<div class="narrative">
<p>Patients start off healthy, and can then progress into progressive disease states (“Sick [S1],” “Sicker [S2]”)—all while facing risks of death due to background causes, and heightened risk of death while sick.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-bubble">
<div class="narrative">

</div>
</div>
<div class="trigger">
<div class="narrative">
<p>DES models are best visualized using a <span style="color:#007bdd"><strong>Petri Net diagram</strong></span>.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-petri1">
<div class="narrative">
<p>Shown here is a Petri Net for the same progressive disease model.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-petri1">
<div class="narrative">
<p>In what follows, we will demonstrate how we conceptualized and constructed this Petri net diagram for a DES.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-petri2">
<div class="narrative">
<p>Doing so will allow us to expand the decision problem to consider an additional dimension—resource contention for a scarce treatment—that is difficult/impossible to capture in Markov and microsimulation modeling approaches.</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-bubble" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/sick-sicker-bubble.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-petri1" class="sticky">
<p><img src="images/petri-model5.png" class="img-fluid"></p>
</div>
<div id="cr-petri2" class="sticky">
<p><img src="images/petri-model6.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<section id="overview-of-petri-nets" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-petri-nets">Overview of Petri Nets</h2>
<p>A Petri net diagram represents the flow of resources, entities, and control through a system over time. They are particularly useful for depicting concurrent processes and shared resources.</p>
<p>A <span style="color:#007bdd"><strong>Petri Net</strong></span> consists of:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 34%">
<col style="width: 19%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Element</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="images/clipboard-3339342299.png" class="img-fluid"></td>
<td style="text-align: center;"><strong>Place</strong></td>
<td style="text-align: left;">Indicate system states or conditions (e.g., “Healthy,” “Sick,” “Under Treatment”).</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="images/clipboard-3059554460.png" class="img-fluid"></td>
<td style="text-align: center;"><strong>Transition</strong></td>
<td style="text-align: left;">Signify events that may cause a change in state (e.g., “disease incidence,” “death,” “recovery”).</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="images/clipboard-810075082.png" class="img-fluid" width="45"> <img src="images/clipboard-1758535931.png" class="img-fluid"></td>
<td style="text-align: center;"><strong>Token</strong></td>
<td style="text-align: left;">Represent individual entities (e.g., patients, hospital beds or available treatment slots) that flow through the net.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="images/clipboard-1434672209.png" class="img-fluid"></td>
<td style="text-align: center;"><strong>Arc</strong></td>
<td style="text-align: left;">Show the flow between places and transitions.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="petri-net-for-the-progressive-disease-model" class="level1">
<h1>Petri Net for the Progressive Disease Model</h1>
<div class="cr-section cr-column-screen overlay-center">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-model1">
<div class="narrative">
<p>We start with a simple model that follows patients for <span class="math inline">\(T\)</span> time units.</p>
</div>
</div>
<div class="trigger new-trigger" data-scale-by="1.5" data-pan-to="65%, 20%" data-focus-on="cr-model1">
<div class="narrative">
<p>In this simple model, we have a population of “tokens” that start off in the healthy state.</p>
</div>
</div>
<div class="trigger new-trigger" data-pan-to="-50%, -35%" data-focus-on="cr-model1">
<div class="narrative">
<p>To begin, we will assume this population can only experience one event:reaching the end of the simulation at some time T.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1">
<div class="narrative">

</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-model1" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-inputs0">
<div class="narrative">
<p>Our first step is to define the parameters governing the simulation. In this case the list of parameters is small.</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-inputs0" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="at">N       =</span> <span class="dv">1</span>,  <span class="co"># Total number of patients to simulate. </span></span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="at">horizon =</span> <span class="dv">30</span>  <span class="co"># Time horizon (years)</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cr-section cr-column-screen overlay-center">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-model1_2">
<div class="narrative">
<p>We next need to step back and think about two concepts we defined above: <span style="color:#79AF97FF"><strong>resources</strong></span> and <span style="color:#00A1D5FF"><strong>events</strong></span>.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>Let’s think first about <span style="color:#9FA8DA"><strong>resources</strong></span>. Resources are elements that a patient may use or consume during their time in the simulation. We use the terms “use” and “consume” somewhat loosely here, because a resource could be something like a hospital bed that is needed for treatment—or it could simply be an element like time that is not constrained.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>In this very simple model, we need to conceptualize our first resource, which is <span style="color:#9FA8DA"><strong>time in model</strong></span>.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-resources0">
<div class="narrative">
<p>The image here shows a single patient trajectory over time. We begin tracking the patient at baseline (t=0) and follow them until the end of the time horizon has been met at 30 years.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-resources1">
<div class="narrative">
<p>We can therefore define a resource called <span style="color:#9FA8DA"><strong>time in model</strong></span> that we track. In this case, it will trivially be 30 years for every simulated patient.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-resources1-death">
<div class="narrative">
<p>But that does not always need to be the case! Suppose the patient dies at some time before t=30. In that case, their time in the model will be shorter.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>It’s also important to note that in this example patient trajectory, the resource <code>time_in_model</code> is unconstrained. That is, one simulated patient’s experience of time does not inhibit or limit another patient from also experiencing the elapse of time.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-resources1">
<div class="narrative">
<p>Because the patient is followed for a defined time horizon, we can think of the resource as beginning at the initiation of the model, and ending after the time horizon is met.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-resources2">
<div class="narrative">
<p>The way DES conceptualizes this idea is that the resource is “seized” upon initiation of the model, and then “released” upon exit from the model. These two time stamps can then be used to calculate the total time the resource was “used.”</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-resources2">
<div class="narrative">
<p>Often, the seizure and/or release of resources is triggered by <span style="color:#F44336"><strong>events</strong></span>. We’ll cover how to handle events in just a bit.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-countertable0">
<div class="narrative">

</div>
</div>
<div class="trigger">
<div class="narrative">
<p>Resources are tracked in a <strong>counter</strong> object. In this very simple model, we only have a single resource to track: <code>time_in_model</code>.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-counter0">
<div class="narrative">
<p>In R, the object <code>counters</code> is defined as a vector listing the various resources that we want to track in the model.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-counter0">
<div class="narrative">

</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-model1_2" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-model1-resources0" class="sticky">
<p><img src="images/model1-resources0.png" class="img-fluid"></p>
</div>
<div id="cr-model1-resources1" class="sticky">
<p><img src="images/model1-resources1.png" class="img-fluid"></p>
</div>
<div id="cr-model1-resources1-death" class="sticky">
<p><img src="images/model1-resources1-death.png" class="img-fluid"></p>
</div>
<div id="cr-model1-resources1" class="sticky">
<p><img src="images/model1-resources2.png" class="img-fluid"></p>
</div>
<div id="cr-model1-resources2" class="sticky">
<p><img src="images/model1-resources2.png" class="img-fluid"></p>
</div>
<div id="cr-countertable0" class="sticky">
<table class="caption-top table">
<caption>DES Model Counters</caption>
<thead>
<tr class="header">
<th>counter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>time_in_model</td>
<td>Time (years) patient is tracked in model</td>
</tr>
</tbody>
</table>
</div>
<div id="cr-counter0" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>counters <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="st">"time_in_model"</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<p>Our next step is to define <span style="color:#F44336"><strong>events</strong></span>. In this simple model, we have two:</p>
<ol type="1">
<li>Model initiation</li>
<li>Model exit after the specified horizon has been reached.</li>
</ol>
<div class="cr-section cr-column-screen overlay-center">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-model1-event1">
<div class="narrative">

</div>
</div>
<div class="trigger new-trigger" data-scale-by="2" data-pan-to="50%, -60%" data-focus-on="cr-model1-event2">
<div class="narrative">
<p>Both of these events trigger resource seizure and/or release, in the sense that when a patient is initialized in the model, we want to start the clock on the <code>time_in_model</code> counter.</p>
</div>
</div>
<div class="trigger new-trigger" data-scale-by="2" data-pan-to="-50%, -60%" data-focus-on="cr-model1-event2">
<div class="narrative">
<p>And similarly, when the patient reaches the event of exiting the model at the defined time horizon, we want to stop the clock on <code>time_in_model</code>.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-event2">
<div class="narrative">

</div>
</div>
<div class="trigger">
<div class="narrative">
<p>In the R/Simmer simulation environment, events are handled through functions that modify the trajectory of the patient.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-Rinitialize1">
<div class="narrative">
<p>Let’s start by defining an event for model initialization.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="1" data-focus-on="cr-Rinitialize1">
<div class="narrative">
<p><code>initialize_patient</code> is a function of both <strong>inputs</strong> (i.e., the parameters governing the model) and <strong>trajectories</strong>.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="4" data-focus-on="cr-Rinitialize1">
<div class="narrative">
<p>It takes the patient’s trajectory and <strong>seizes</strong> the resource <code>time_in_model</code> that we defined above.</p>
</div>
</div>
<div class="trigger new-trigger" data-scale-by="2" data-pan-to="50%, -60%" data-focus-on="cr-model1-event2">
<div class="narrative">
<p>Going back to the single patient trajectory, upon initilization of the patient we have “seized” the <code>time_in_model</code> resource for this patient.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="5" data-focus-on="cr-Rinitialize2">
<div class="narrative">
<p>Though we don’t need it for this very simple model, <code>initialize_patient</code> is also a good place to set initial attributes of patients, such as their age, gender, etc. We can then use (and update!) these attributes in the model so they can govern transitions and other events.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-Rinitialize2">
<div class="narrative">

</div>
</div>
<div class="trigger">
<div class="narrative">
<p>Let’s now construct a similar function <code>terminate_simulation()</code> that releases the resource <code>time_in_model</code> once a patient exits the model.</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-model1-event1" class="sticky">
<p><img src="images/model1-event1.png" class="img-fluid"></p>
</div>
<div id="cr-model1-event2" class="sticky">
<p><img src="images/model1-event2.png" class="img-fluid"></p>
</div>
<div id="cr-Rinitialize1" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>initialize_patient <span class="ot">&lt;-</span> <span class="cf">function</span>(traj, inputs)</span>
<span id="cb3-2"><a href="#cb3-2"></a>{</span>
<span id="cb3-3"><a href="#cb3-3"></a>  traj                   <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">seize</span>(<span class="st">"time_in_model"</span>) </span>
<span id="cb3-5"><a href="#cb3-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cr-Rinitialize2" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>initialize_patient <span class="ot">&lt;-</span> <span class="cf">function</span>(traj, inputs)</span>
<span id="cb4-2"><a href="#cb4-2"></a>{</span>
<span id="cb4-3"><a href="#cb4-3"></a>  traj                   <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">seize</span>(<span class="st">"time_in_model"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">set_attribute</span>(<span class="st">"AgeInitial"</span>, <span class="cf">function</span>() <span class="fu">sample</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">1</span>))</span>
<span id="cb4-6"><a href="#cb4-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-highlight="4" data-focus-on="cr-Rcleanup0">
<div class="narrative">

</div>
</div>
<div class="trigger">
<div class="narrative">
<p>In this function, we take the patient’s trajectory and introduce a <strong>branch</strong>. You can think of this like a chance node in a decision tree—this puts our patient at a fork in the road, and each pathway has its own probability of being taken.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>In this case, however, the patient is exiting the model. So this is a trivial function with only one option that has a probability of one.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="5" data-focus-on="cr-Rcleanup0">
<div class="narrative">
<p>The option <code>continue</code> is also set to false—indicating that after this branch has been passed, the model will stop running.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>Branches are key coding elements of DES, and allow for updating event times and other aspects of the model that may change over time, or probabilistically due to the occurance of events. In the event a branch is used to update attributes or event times, you woulld set <code>continue=TRUE</code>.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<p>Branches will also be key for how we conceptualize and model resource constraints later on.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="7" data-focus-on="cr-Rcleanup0">
<div class="narrative">
<p>Once the patient has passed through the branch, we release the resource <code>time_in_model</code>.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="1-5" data-focus-on="cr-Rcleanup1">
<div class="narrative">
<p>In our experience, it is often helpful to split this process into two parts: <span class="hl hl-cyan">A function that releases any resources on exit</span>.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="7-15" data-focus-on="cr-Rcleanup1">
<div class="narrative">
<p>And a separate <span class="hl hl-cyan">function that terminates the simulation</span> .</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-Rcleanup2">
<div class="narrative">

</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-Rcleanup0" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>terminate_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(traj, inputs)</span>
<span id="cb5-2"><a href="#cb5-2"></a>{</span>
<span id="cb5-3"><a href="#cb5-3"></a>  traj <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">branch</span>( <span class="cf">function</span>() <span class="dv">1</span>, </span>
<span id="cb5-5"><a href="#cb5-5"></a>          <span class="at">continue=</span><span class="cn">FALSE</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>          <span class="fu">trajectory</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>            <span class="fu">release</span>(<span class="st">"time_in_model"</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>        )</span>
<span id="cb5-9"><a href="#cb5-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cr-Rcleanup1" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>cleanup_on_termination <span class="ot">&lt;-</span> <span class="cf">function</span>(traj)</span>
<span id="cb6-2"><a href="#cb6-2"></a>{</span>
<span id="cb6-3"><a href="#cb6-3"></a>  traj <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">release</span>(<span class="st">"time_in_model"</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>}</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>terminate_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(traj, inputs)</span>
<span id="cb6-8"><a href="#cb6-8"></a>{</span>
<span id="cb6-9"><a href="#cb6-9"></a>  traj <span class="sc">|&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">branch</span>( <span class="cf">function</span>() <span class="dv">1</span>, </span>
<span id="cb6-11"><a href="#cb6-11"></a>          <span class="at">continue=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>          <span class="fu">trajectory</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-13"><a href="#cb6-13"></a>            <span class="fu">cleanup_on_termination</span>()</span>
<span id="cb6-14"><a href="#cb6-14"></a>        )</span>
<span id="cb6-15"><a href="#cb6-15"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cr-Rcleanup1" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>cleanup_on_termination <span class="ot">&lt;-</span> <span class="cf">function</span>(traj)</span>
<span id="cb7-2"><a href="#cb7-2"></a>{</span>
<span id="cb7-3"><a href="#cb7-3"></a>  traj <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">release</span>(<span class="st">"time_in_model"</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cr-Rcleanup2" class="sticky">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>terminate_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(traj, inputs)</span>
<span id="cb8-2"><a href="#cb8-2"></a>{</span>
<span id="cb8-3"><a href="#cb8-3"></a>  traj <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">branch</span>( <span class="cf">function</span>() <span class="dv">1</span>, </span>
<span id="cb8-5"><a href="#cb8-5"></a>          <span class="at">continue=</span><span class="cn">FALSE</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>          <span class="fu">trajectory</span>() <span class="sc">|&gt;</span> <span class="fu">cleanup_on_termination</span>()</span>
<span id="cb8-7"><a href="#cb8-7"></a>        )</span>
<span id="cb8-8"><a href="#cb8-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="scratch" class="level1">
<h1>Scratch</h1>
<div class="cr-section cr-column-screen overlay-center">
<div class="narrative-col">
<div class="trigger">
<div class="narrative">
<p>The first thing we want to track is the trajectory of the patient through the model.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model1-init">
<div class="narrative">
<p>We need to initialize the patient</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model2">
<div class="narrative">
<p>We’ll next add in a death state.</p>
</div>
</div>
<div class="trigger">
<div class="narrative">
<ol class="example" type="1">
<li>Now we allow for two health states: healthy and sick.</li>
</ol>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model4">
<div class="narrative">
<p>We can allow for an event transition back to the healthy state.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model5">
<div class="narrative">
<p>We add in progressive disease.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model6">
<div class="narrative">
<p>And finally, we add in a treatment with resource constraints (e.g., limited beds, surgical appointment spots, etc.)</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-model6">
<div class="narrative">

</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-model1-init" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model1_initialize.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-model2" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-model3" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model3.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-model4" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model4.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-model5" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model5.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="cr-model6" class="sticky">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/petri-model6.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Petri nets offer a <strong>graphical grammar</strong> that aligns neatly with discrete-event simulation (DES):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 20%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Element</th>
<th>Symbol</th>
<th>In our disease model…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Place</em></td>
<td>● (circle)</td>
<td>Clinical states (<code>H</code>, <code>S1</code>, <code>S2</code>), queues, resources</td>
</tr>
<tr class="even">
<td><em>Token</em></td>
<td></td>
<td>A single patient or a unit of resource capacity</td>
</tr>
<tr class="odd">
<td><em>Transition</em></td>
<td>▭ (bar/rectangle)</td>
<td>Events: incidence, progression, death, censoring, resource release</td>
</tr>
<tr class="even">
<td><em>Arc</em></td>
<td>→</td>
<td>Preconditions &amp; results of an event</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A transition <strong>fires</strong> only when every input place supplies at least one token —<br>
perfect for competing-risk logic in progressive disease.</p>
</div>
</div>
<!-- # Extra Stuff -->
<!-- <span class="hl hl-blue">blue highlighted text</span>  -->
<!-- <span class="hl hl-red">red highlighted text</span>  -->
<!-- <span class="hl hl-cyan">cyan highlighted text</span>  -->
<!-- <span class="hl hl-green">green highlighted text</span>  -->
<!-- <span class="hl hl-brown">brown highlighted text</span>  -->
<!-- Here's some <span style="color:cornflowerblue">**some bolded blue text**</span> -->
<!-- How about some <span style="color:firebrick">**red bolded text**</span> -->
<!-- How about some <span style="color:darkcyan">**cyan bolded text**</span>  -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-alarid2023introductory" class="csl-entry" role="listitem">
Alarid-Escudero, Fernando, Eline Krijkamp, Eva A Enns, Alan Yang, MG Myriam Hunink, Petros Pechlivanoglou, and Hawre Jalal. 2023. <span>“An Introductory Tutorial on Cohort State-Transition Models in r Using a Cost-Effectiveness Analysis Example.”</span> <em>Medical Decision Making</em> 43 (1): 3–20.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>